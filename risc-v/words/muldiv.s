# SPDX-License-Identifier: GPL-3.0-only
# -----------------------------------------------------------------------------
#  Multiplication, Division and Remainder available as opcodes in RV32IM
#  Rewrite these to get a pure RV32I Forth.
# -----------------------------------------------------------------------------

# -----------------------------------------------------------------------------
  CODEWORD  "m*", MSTAR # ( n1 n2 -- d )
# -----------------------------------------------------------------------------
  lw t0, 0(s4)
  mul t1, t0, s3
  sw t1, 0(s4)
  mulh s3, t0, s3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD  "/", SLASH # ( n2 n1 -- n2/n1 ) MATHS: TOS becomes NOS/TOS
# -----------------------------------------------------------------------------
  lw t0, 0(s4)
  addi s4, s4, 4
  div s3, t0, s3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD  "mod", MOD # ( n2 n1 -- n2%n1 ) MATHS: TOS becomes NOS % TOS
# -----------------------------------------------------------------------------
  lw t0, 0(s4)
  addi s4, s4, 4
  rem s3, t0, s3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD  "u/mod", U_SLASH_MOD # ( u1 u2 -- rem quot )
# -----------------------------------------------------------------------------
  lw t0, 0(s4)
  remu t1, t0, s3
  sw t1, 0(s4)
  divu s3, t0, s3
  NEXT

# -----------------------------------------------------------------------------
  CODEWORD  "/mod", SLASHMOD # ( n1 n2 -- rem quot )
# -----------------------------------------------------------------------------
  lw t0, 0(s4)
  rem t1, t0, s3
  sw t1, 0(s4)
  div s3, t0, s3
  NEXT
 
